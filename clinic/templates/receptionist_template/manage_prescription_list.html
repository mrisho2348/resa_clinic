{% extends 'receptionist_template/base_template.html' %}

{% block title %}
Prescription 
{% endblock title %}

{% block page_title %}
Prescription 
{% endblock page_title %}

{% block breadcrumb %}
{% include "receptionist_template/modal_form.html" %}
{% comment %} <a class="btn btn-primary float-right" type="button" data-toggle="modal" data-target="#addPrescriptionModal">
    <i class="fas fa-plus"></i> New Prescription
</a> {% endcomment %}
<!-- Add Import insurance link and modal trigger -->
<a class="btn btn-success float-right mr-2" href="{% url 'import_prescription_records' %}">
  <i class="fas fa-file-import"></i> Import Prescription
</a>
{% endblock breadcrumb %}


{% load static %}
{% block main_content %}
<p class="total-payment">Total Payment for All Prescription: {{ total_price }}/Tsh</p>

<style>
    .total-payment {
        font-family: 'Roboto', sans-serif; /* Use a custom font */
        font-weight: bold;
        font-size: 24px;
        color: #2c3e50; /* Text color */
        background-color: #f1c40f; /* Background color */
        padding: 10px 20px; /* Padding around the text */
        border-radius: 10px; /* Rounded corners */
        border: 2px solid #e67e22; /* Border */
        display: inline-block; /* Display as inline block */
        margin-bottom: 20px; /* Bottom margin for spacing */
        box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1); /* Box shadow */
        transition: background-color 0.3s ease; /* Smooth background color transition */
    }
    
    .total-payment:hover {
        background-color: #e67e22; /* Change background color on hover */
        color: #fff; /* Change text color on hover */
    }
    
</style>
<div class="table-responsive">
  <table class="table table-hover text-nowrap table-responsive-sm table-bordered table-striped table-sm  display" id="example"  style="width:100%">
      <thead>
          <tr>      
              <th>Visit Number</th>
              <th>Patient</th>              
              <th>Billing Amount</th>  
              <th>Created At</th>                    
              <th>Action</th>               
          </tr>
      </thead>
      <tbody>
          {% for visit_total in visit_total_prices %}
              <tr>           
                  <td>{{ visit_total.visit__vst }}</td> <!-- Display visit number -->
                  <td>{{ visit_total.visit__patient__first_name }} {{ visit_total.visit__patient__middle_name }}  {{ visit_total.visit__patient__last_name }}</td> <!-- Display patient name -->
                  <td>{{ visit_total.total_price }}</td> <!-- Display total price for the visit -->
                  <!-- Adjust other columns as needed -->
                  <td>{{ visit_total.visit__created_at }}</td> <!-- Assuming visit has created_at attribute -->
                  <td>
                      <button class="btn btn-dark btn-sm" data-toggle="modal" data-target="#editPrescriptionModal{{ visit_total.visit.id }}"  data-toggle="tooltip" title="Edit">
                          <i class="fa fa-edit text-white"></i>
                      </button>
                      <button class="btn btn-danger btn-sm" data-toggle="modal" data-target="#deletePrescriptionModal{{ visit_total.visit.id }}"  data-toggle="tooltip" title="Delete">
                          <i class="fas fa-trash"></i>
                      </button>    
                  </td>         
                  <!-- Delete Modal -->
                  <div class="modal fade" id="deletePrescriptionModal{{ visit_total.visit.id }}" tabindex="-1" role="dialog" aria-labelledby="deleteInventoryItemModalLabel{{ visit_total.visit.id }}" aria-hidden="true">
                      <div class="modal-dialog" role="document">
                          <div class="modal-content">
                              <div class="modal-header">
                                  <h5 class="modal-title" id="deletePrescriptionModalLabel{{ visit_total.visit.id }}">Delete Prescription</h5>
                                  <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                      <span aria-hidden="true">&times;</span>
                                  </button>
                              </div>
                              <div class="modal-body">
                                  <p>Are you sure you want to delete this Prescription: <strong>{{ visit_total.visit.id }}</strong>?</p>
                              </div>
                              <div class="modal-footer">
                                  <button type="button" class="btn btn-secondary" data-dismiss="modal">Cancel</button>
                                  <button type="button" class="btn btn-danger" onclick="deletePrescription({{ visit_total.visit.id }})">Delete</button>
                              </div>
                          </div>
                      </div>
                  </div>            
              </tr>
          {% endfor %}
      </tbody>
  </table>
</div>


{% include 'receptionist_template/datatable.html' %}
{% endblock main_content %}
